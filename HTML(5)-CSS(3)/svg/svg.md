# SVG

**可缩放矢量图形**（Scalable Vector Graphics，SVG），是一种用于描述二维的矢量图形，基于 XML 的标记语言。作为一个基于文本的开放网络标准，SVG 能够优雅而简洁地渲染不同大小的图形，并和 CSS，DOM，JavaScript 和 SMIL 等其他网络标准无缝衔接。本质上，SVG 相对于图像，就好比 HTML 相对于文本。

SVG 图像及其相关行为被定义于 XML 文本文件之中，这意味着可以对它们进行搜索、索引、编写脚本以及压缩。此外，这也意味着可以使用任何文本编辑器和绘图软件来创建和编辑它们。

和传统的点阵图像模式（JPEG 和 PNG）不同，SVG 格式提供的是矢量图，这意味着它的图像能够被无限放大而不失真或降低质量，并且可以方便地修改内容。

## 引言

SVG 是一种 XML 语言，类似 XHTML，可以用来绘制矢量图形。SVG 可以通过定义必要的线和形状来创建一个图形，也可以修改已有的位图，或者将这两种方式结合起来创建图形。图形和其组成部分可以形变（be transformed）、合成、或者通过滤镜完全改变外观。

### 基本要素

SVG也提供了一些元素，用于定义圆形、矩形、简单或复杂的曲线。一个简单的 SVG 文档由 `<svg>` 根元素和基本的形状元素构成。

- SVG 的元素和属性必须按标准格式书写，因为 XML 是区分大小写的（这一点和HTML不同）
- SVG 里的属性值必须用引号引起来，就算是数值也必须这样做。

## 入门

### SVG 文件的基本属性

最值得注意的一点是元素的渲染顺序。SVG 文件全局有效的规则是“后来居上”，越后面的元素越可见。

web 上的 svg 文件可以直接在浏览器上展示，或者通过以下几种方法嵌入到 HTML 文件中：
- 如果 HTML 是 XHTML 并且声明类型为 `application/xhtml+xml`，可以直接把 SVG 嵌入到 XML 源码中。
- 如果 HTML 是 HTML5 并且浏览器支持 HTML5，同样可以直接嵌入 SVG。然而为了符合 HTML5 标准，可能需要做一些语法调整。
- 可以通过 `object` 元素引用 `SVG` 文件：

```html
<object data="image.svg" type="image/svg+xml" />
```

- 类似的也可以使用 `iframe` 元素引用 SVG 文件（大小会被 `iframe` 影响）：

```html
<iframe src="image.svg"></iframe>
```

- 理论上同样可以使用 `img` 元素，但是在低于 4.0 版本的 Firefox 中不起作用。
- 最后 SVG 可以通过 JavaScript 动态创建并注入到 HTML DOM 中。这样具有一个优点，可以对浏览器使用替代技术，在不能解析 SVG 的情况下，可以替换创建的内容。

### SVG 文件类型

SVG 文件有两种形式。

- **普通 SVG 文件**：是包含 SVG 标记的简单文本文件。推荐使用 “`.svg`”（全部小写）作为此类文件的扩展名。

- **gzip 压缩的 SVG 文件**：由于在某些应用（比如地图应用等）中使用时，SVG 文件可能会很大，SVG 标准同样允许 gzip 压缩的 SVG 文件。推荐使用 “`.svgz`”（全部小写）作为此类文件扩展名 。

> 除非知道处理发布内容的 web 服务器可以正确的处理 gzip，否则要避免使用 gzip 压缩的 SVG。

## 坐标定位

### 网格

对于所有元素，SVG 使用的坐标系统或者说网格系统，和 Canvas 用的差不多（所有计算机绘图都差不多）。

**什么是 "像素"?**

基本上，在 SVG 文档中的1个像素对应输出设备（比如显示屏）上的1个像素。但是这种情况是可以改变的，否则 SVG 的名字里也不至于会有“Scalable”（可缩放）这个词。

在没有进一步规范说明的情况下，1 个用户单位等同于 1 个屏幕单位。要明确改变这种设定，SVG 里有多种方法。

```html
<svg width="200" height="200" viewBox="0 0 100 100">
```

这里定义的画布尺寸是 `200*200px`。但是，`viewBox` 属性定义了画布上可以显示的区域：从 `(0,0)` 点开始，`100宽*100高` 的区域。这个 `100*100` 的区域，会放到 `200*200` 的画布上显示。于是就形成了放大两倍的效果。

用户单位和屏幕单位的映射关系被称为用户坐标系统。除了缩放之外，坐标系统还可以旋转、倾斜、翻转。。在定义了具体尺寸单位的 SVG 中，比如单位是 “`cm`” 或 “`in`”，最终图形会以实际大小的1比1比例呈现。

## 基本形状

要想插入一个形状，你可以在文档中创建一个元素。不同的元素对应着不同的形状，并且使用不同的属性来定义图形的大小和位置。有一些形状因为可以由其他的形状创建而略显冗余， 但是它们用起来方便，可让我们的 SVG 文档简洁易懂。

### 矩形

```html
<rect x="10" y="10" width="30" height="30"/>
<rect x="60" y="10" rx="10" ry="10" width="30" height="30"/>
```

- x`
  - 矩形左上角的x位置
- y`
  - 矩形左上角的y位置
- width`
  - 矩形的宽度
- height`
  - 矩形的高度
- rx`
  - 圆角的 x 方位的半径
- ry`
  - 圆角的 y 方位的半径

### 圆形

```html
<circle cx="25" cy="75" r="20"/>
```

- `r`
  - 圆的半径
- `cx`
  - 圆心的x位置
- `cy`
  - 圆心的y位置

### 椭圆

椭圆不能指定精确的椭圆倾向（假设，举个例子，想画一个45度角倾斜的椭圆），但是可以利用 `transform` 属性实现旋转。

```html
<ellipse cx="75" cy="75" rx="20" ry="5"/>
```

- `rx`
  - 椭圆的 x 半径
- `ry`
  - 椭圆的 y 半径
- `cx`
  - 椭圆中心的 x 位置
- `cy`
  - 椭圆中心的 y 位置

### 线条

```html
<line x1="10" x2="50" y1="110" y2="150"/>
```

- `x1`
 - 起点的 x 位置
- `y1`
 - 起点的 y 位置
- `x2`
 - 终点的 x 位置
- `y2`
 - 终点的 y 位置

### 折线

```html
<polyline points="60 110, 65 120, 70 115, 75 130, 80 125, 85 140, 90 135, 95 150, 100 145"/>
```

- `points`
  - 点集数列。每个数字用空白、逗号、终止命令符或者换行符分隔开。每个点必须包含 2 个数字，一个是 x 坐标，一个是 y 坐标。所以点列表 `(0,0), (1,1)` 和 `(2,2)` 可以写成这样：“`0 0, 1 1, 2 2`”。

### 多边形

`polygon` 和折线很像，它们都是由连接一组点集的直线构成。不同的是，`polygon` 的路径在最后一个点处自动回到第一个点。

> 需要注意的是，矩形也是一种多边形，如果需要更多灵活性的话，你也可以用多边形创建一个矩形。

```html
<polygon points="50 160, 55 180, 70 180, 60 190, 65 205, 50 195, 35 205, 40 190, 30 180, 45 180"/>
```

- `points`
  - 点集数列。路径绘制完后闭合图形。

### 路径

`path` 可能是 SVG 中最常见的形状。你可以用 `path` 元素绘制矩形（直角矩形或者圆角矩形）、圆形、椭圆、折线形、多边形，以及一些其他的形状，例如贝塞尔曲线、2次曲线等曲线。

```html
<path d="M 20 230 Q 40 205, 50 230 T 90230"/>
```

- `d`
  - 一个点集数列以及其它关于如何绘制路径的信息。

## 路径

`<path>` 元素是 SVG 基本形状中最强大的一个。你可以用它创建线条, 曲线, 弧形等等。另外，`path`只需要设定很少的点，就可以创建平滑流畅的线条（比如曲线）。虽然 `polyline` 元素也能实现类似的效果，但是必须设置大量的点（点越密集，越接近连续，看起来越平滑流畅），并且这种做法不能够放大（放大后，点的离散更明显）。所以在绘制 SVG 时，对路径的良好理解很重要。

`path` 元素的形状是通过属性 `d` 定义的，属性 `d` 的值是一个“命令+参数”的序列。

每一个命令都用一个关键字母来表示，比如，字母“`M`”表示的是“Move to”命令，当解析器读到这个命令时，它就知道你是打算移动到某个点。

跟在命令字母后面的，是你需要移动到的那个点的 x 和 y 轴坐标。比如移动到 `(10,10)` 这个点的命令，应该写成 “`M 10 10`”。这一段字符结束后，解析器就会去读下一段命令。

每一个命令都有两种表示方式，一种是用 **大写字母**，表示采用 *绝对定位*。另一种是用 **小写字母**，表示采用 *相对定位*。

> 因为属性 `d` 采用的是用户坐标系统，所以不需标明单位。

### 直线命令

`<path>` 元素里有 5 个画直线的命令，顾名思义，直线命令就是在两个点之间画直线。

能够真正画出线的命令有三个（M命令是移动画笔位置，但是不画线）:

- L
- H 绘制水平线
- V 绘制垂直线

**M**

```shell
M x y
# or
m dx dy
```

**L**

```shell
L x y
# or
l dx dy
```

**H**

```shell
H x
# or
h dx
```

**V**

```shell
V y
# or
v dy
```

**Z**

`Z` 命令会从当前点画一条直线到路径的起点，尽管我们不总是需要闭合路径，但是它还是经常被放到路径的最后。另外，`Z` 命令不用区分大小写。

```shell
Z
# or
z
```

### 曲线命令

**贝塞尔曲线**

三次贝塞尔曲线需要定义一个点和两个控制点，需要设置三组坐标参数：

```shell
C x1 y1, x2 y2, x y
# or
c dx1 dy1, dx2 dy2, dx dy
```

> 这里的最后一个坐标 `(x,y)` 表示的是曲线的终点，所以实际画三次贝塞尔曲线，还要设置一个起点。

```html
<path d="M10 10 C 20 20, 40 20, 50 10" stroke="black" />
```

你可以将若干个贝塞尔曲线连起来，从而创建出一条很长的平滑曲线。通常情况下，一个点某一侧的控制点是它另一侧的控制点的对称（以保持斜率不变）。这样，你可以使用一个简写的贝塞尔曲线命令 `S`，如下所示：

```shell
S x2 y2, x y
# or
s dx2 dy2, dx dy
```

`S` 命令可以用来创建与前面一样的贝塞尔曲线，但是，如果 S 命令跟在一个 C 或 S 命令后面，则它的第一个控制点会被假设成前一个命令曲线的第二个控制点的中心对称点。如果 S 命令单独使用，前面没有 C 或 S 命令，那当前点将作为第一个控制点。



---

参考

1.[SVG文档](https://developer.mozilla.org/zh-CN/docs/Web/SVG)
