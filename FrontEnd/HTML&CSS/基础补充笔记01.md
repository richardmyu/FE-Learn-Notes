# HTML & CSS 基础补充

## 1.隐藏元素的方法

### 1.1.HTML

- `display: none;`
- `visibility: hidden;`
- `opacity: 0;`
- `position: relative/absolute/fixed; left:-120px;`
- `margin-left: -110px;`
- `clip-path: polygon(0px 0px, 0px 0px, 0px 0px, 0px 0px);`

## 2.zoom 和 scale 的区别

参考：[小 tips: zoom 和 transform:scale 的区别](http://www.zhangxinxu.com/wordpress/2015/11/zoom-transform-scale-diff/)

### 2.1.IE 和 Chrome 等浏览器与 zoom

zoom 的字面意思是“变焦”，摄影的时候常用到的一个概念。对于 web 上的 zoom 效果，你也可以按照此概念理解。可以改变页面上元素的尺寸，属于真实尺寸。

其支持的值类型有：

- 百分比值：`zoom:50%`，表示缩小到原来的一半。
- 数值：`zoom:0.5`，表示缩小到原来的一半。
- `normal`关键字：`zoom:normal`等同于`zoom:1`。

> 注意，虽然 Chrome/Safari 浏览器支持了 zoom 属性，但是，其实 zoom 并不是标准属性。

### 2.2.CSS3 transform 下的 scale

而 `transform` 下的 `scale` 就不一样了，是明明确确写入规范的。从 IE9+ 到其他现代浏览器都支持。语法为：`transform: scale(<x> [<y>])`. 同时有 `scaleX`, `scaleY` 专门的 x, y 方向的控制。

和 `zoom` 不同，`scale` 值只能是数值。而且，还能是负数，没错，负数。而 `zoom` 不能是负值！

### 2.3.差异

先总结下上面表面所见的差异：

- 浏览器兼容性。
- 控制缩放的值不一样。`zoom` 更全面，但是不能是负数，只能等比例控制；而 `scale` 虽然只能是数值，但是能负数，可以只控制 1 个维度。

然而，更深层次的差异才是更重要的。

- `zoom` 的缩放是相对于左上角的；而 `scale` 默认是居中缩放；
- `zoom` 的缩放改变了元素占据的空间大小；而 `scale` 的缩放占据的原始尺寸不变，页面布局不会发生变化(影响的是视距？？？)；
- 对文字的缩放规则不一致。`zoom` 缩放依然受限于最小 12 像素中文大小限制；而 `scale` 就是纯粹的对图形进行比例控制，文字 50% 原来尺寸。
- 还有一个肉眼看不见却更重要的差异，**渲染的性能差异明显**(`zoom` 会引起页面重绘，而 `scale` 只会导致当前元素的重绘)。

由于 `zoom` 的缩放会改变元素的真实空间大小，换句话说，实时影响了其他小伙伴。

根据我的一些同事的测试，在文档流中 `zoom` 加在任意一个元素上都会引起一整个页面的重新渲染，而 `scale` 只是在当前的元素上重绘。这其实很好理解，对吧。`scale` 呢变化时候，其原本的尺寸是不变的，因此，就没有 layout 的重计算；但是 `zoom` 牵一发动全身，就麻烦地多！

这就让我们要斟酌下移动端一些功能的实现了。

我们要实现元素的缩放效果，可以使用 CSS3 `animation`, 但是存在这样一种情况，就是元素原本就使用了一些 `transform` 属性进行，此时，再使用 `scale` 进行 `animation` 缩放，就会覆盖原来的值，事情就会变得麻烦。

聪明的小伙伴想到了一个方法，就是使用 zoom 做动画。从效果上讲，`zoom` 是可以的；但是，从性能上讲，大家就要掂量掂量了。

至于 `zoom` 缩放不是按照中心点缩放的这个兼容性差异，通过使用「海洋布局」实现，具体可参考“[IE 下 zoom 或 Matrix 矩阵滤镜中心点变换实现](http://www.zhangxinxu.com/wordpress/2015/02/ie-zoom-transform-filter/)”一文，其中就有兼容使用 `zoom/scale` 的例子。

在移动端，大家也可以使用 `zoom` 进行一些静态内容的控制，可以避免为了 `scale` 而占有 `translate`, `rotate`, `skew` 等公用的 `transform` 属性。

> 需要注意的是，Chrome 等浏览器下，`zoom/scale` 不要同时使用，因为，缩放效果会累加。

## 3.常见的浏览器兼容问题有哪些

### 3.1.不同浏览器的标签默认 margin 和 padding 不同

发生概率：100%

解决方案：

`*{ margin: 0; padding: 0;}`

### 3.2.IE6 双边距 bug

块属性标签 `float` 之后，又有横向的 `margin` 值，在 IE6 中显示会比设置的大

发生概率：90%

解决方案：在 `float` 标签样式控制中加入 `display:inline`;

### 3.3.设置较小的高度标签（一般小于 10px），在 IE6，IE7 遨游中超出自己设置的高度

发生概率：60%

解决方案：给超出高度的标签设置 `overflow:hidden;` 或者设置行高 `line-height` 小于你设置的高度。

### 3.4.图片默认有间距

发生概率：20%

解决方案：使用 `float` 为 `img` 布局

### 3.5.标签最低高度设置 `min-height` 不兼容

发生概率：5%

解决方案：例如要设置一个标签的最小高度为 200px

```css
 {
  min-height: 200px;
  height: auto !important;
  height: 200px;
  overflow: visible;
}
```

### 3.6. 透明度兼容设置

发生概率：主要看你要写的东西设不设透明度

解决方案：一句话

```css
transparent_class {
  filter: alpha(opacity=50);
  -moz-opacity: 0.5;
  -khtml-opacity: 0.5;
  opacity: 0.5;
}
```

### 3.7.Box Model 的 bug

描述：给一个元素设置了高度和宽度的同时，还为其设置 `margin` 和 `padding` 的值，会改变该元素的实际大小。

解决办法：在需要加 `margin` 和 `padding` 的 `div` 内部加一个 `div`,在这个 `div` 里设置 `margin` 和 `padding` 值。

### 3.8.IE6 中的列表 li 楼梯状 bug

描述：通常在 `li` 中的元素（比如 `a`）设置了浮动 `float`，但 `li` 本身不浮动。

解决办法：

`ul li{float:left;}` 或 `ul li{display:inline;}`

### 3.9.li 空白间距

描述：在 IE 下，会增加 `li` 和 `li` 之间的垂直间距

解决办法：给 `li` 里的 `a` 显式的添加宽度或者高度

`li a{width:20px;}`

或者

`li a{display:block;float:left;clear:left;}`

或者

`li {display:inline;}`
`li a{display:block;}`

或者

在每个列表 `li` 上设置一个实线的底边，颜色和 `li` 的背景色相同

### 3.10.overflow：auto; 和 position: relative; 的碰撞

描述：此 bug 只出现在 IE6 和 IE7 中，有两个块级元素，父元素设置了 `overflow：auto;` 子元素设置了 `position:relative;` 且高度大于父元素，在 IE6-7 中子元素不会被隐藏而是溢出。

解决方案：给父元素也设置 `position: relative;`

### 3.11.浮动层的错位

描述：当内容超出外包容器定义的宽度时会导致浮动层错位问题。在 Firefox、IE7、IE8 及其他标准浏览器里,超出的内容仅仅只是超出边缘;但在 IE6 中容器会忽视定义的 `width` 值,宽度会错误地随内容宽度增长而增长。如果在这个浮动元素之后还跟着一个浮动元素,那么就会导致错位问题。

解决方案：`overflow: hidden;`

### 3.12.IE6 克隆文本的 bug

描述：若你的代码结构如下

```html
<!--这是注释-->

<div>
  ……
</div>
<!--这是注释-->
```

很有可能在 IE6 网页上出现一段空白文本

解决方案：

- 使用条件注释
- 删除所有注释
- 在注释前面的那个浮动元素加上 `display: inline;`

### 3.13.IE 的图片缩放

描述：图片在 IE 下缩放有时会影响其质量

解决方案：`img{ -mg-interpolation-mode:bicubic;}`

### 3.14.IE6 下 png 图片的透明 bug

描述：使用透明图片,使用 png24 或 png32 图片在 IE6 下 面显示图片会有一层淡蓝色的背景。

解决方案：

```css
.img {
  background: url("xxx");
  _background: 0;
  _filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='xxx',sizingMethod='scale');
}

img {
  filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='xxx',sizingMethod='scale');
}
```

或

```html
<img
  src="test.png"
  width="247"
  height="216"
  style="filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='xxx',sizingMethod='scale');"
  alt=""
/>
```

### 3.15.`<iframe>` 透明背景 bug

描述：在 IE 浏览器中，`<iframe>` 框架不会自动把背景设为透明

解决方案：

`<iframesrc="content.html" allowTransparency="true"></iframe>`

在 iframe 调用的 `content.html` 页面中设置

`body{background-color: transparent;}`

### 3.16.禁用 IE 默认的垂直滚动条

解决方案：

```css
html {
  overflow: auto;
}
```

### 3.17.居中问题

`div` 里的内容，IE 默认为居中，而 FF 默认为左对齐，可以尝试增加代码：

`margin: 0 auto;`

[通用 hack 方法/CSS 兼容方案/js 兼容方案全推送](https://zhuanlan.zhihu.com/p/25123086?refer=dreawer)

## 4.通用 hack 方法篇

### 4.1 CSS hack 和 filter 原理

1).利用浏览器自身的 bug 来实现特定浏览器的样式
2).利用浏览器对 CSS 的完善度来实现，例如某些 CSS 规则或语法的支持程度，原理类似目前我们经常使用的 `-wekit-`　之类的属性；

### 4.2 IE 条件注释

IE 的条件注释仅仅针对 IE 浏览器，对其他浏览器无效；例如下面的语法：

```html
<!-- [if IE]>
  		//你想要执行的代码
<![endif]-->
<!-- [if lt IE 8]>
  			//你想要执行的代码
<![endif]-->
<!-- [if ! IE 8]>
  		//你想要执行的代码
<![endif]-->
```

### 4.3 `!important` 关键字

`!important` 在 css 中是声明拥有最高优先级，也就是说，不管 css 的其他优先级，只要 `!important` 出现，他的优先级就最高！遨游 1.6 及更低版本、IE6 及更低版本浏览器不能识别它。尽管这个 `!important` 很实用，但是非到必要的时刻，不要使用它！

### 4.4 属性过滤器（较为常用的 hack 方法）

针对不同的 IE 浏览器，可以使用不同的字符来让特定的版本的 IE 浏览器进行样式控制。

IE hack 写法一览

## 5.CSS 兼容方案篇

### 5.1 a 标签 CSS 顺序

很多新人在写 `a` 标签的样式，会疑惑为什么写的样式没有效果，其实只是写的样式被覆盖了，正确的 `a` 标签顺序应该：

link - visited - hover - active

### 5.2 24 位的 png 图片

IE6 不支持透明咋办？使用 png 透明图片呗，但是需要注意的是 24 位的 PNG 图片在 IE6 是不支持的，解决方案有两种：

- 使用 8 位的 PNG 图片
- 为 IE6 准备一套特殊的图片

### 5.3 透明度

```css
opacity: 0.8; /*通用*/
filter: alpha(opacity=80); /*IE*/
filter: progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=80); /*IE6的写法*/
```

### 5.4 IE6 双边距

行内属性设置了块级属性（`display: block;`）后，会产生双倍边距。
解决方案是在添加一个 `display: inline;` 或者 `display: table;`

### 5.5 双倍 margin

浮动元素设置了 `margin` 在 IE6 下会产生双倍 `margin`。
只要给浮动元素设置 `display: inline;` 就可以了。或者说使用 IE6 的 `hack：_margin；`

### 5.6 min-height 的兼容写法

```css
.divBox {
  min-height: 200px;
  height: auto !important;
  height: 200px;
  overflow: visible;
}
```

### 5.7 盒模型差异

IE 盒模型：`margin` 、 `content`（包含 `border`、`padding`）
W3C 盒模型： `margin` 、`border`、 `padding`、 `content`

CSS3 中的 `box-sizing` 的属性就是为了这两种模式，`border-box`（IE 盒）和 `content-box`（W3C）

### 5.8 img 标签-图片存在边距

使用 `vertical-align` 属性可以清楚这种边距

顺便说下 `a` 标签同样会存在边距，具体的解决方法可以看看去除 `inline-block` 元素间间距的 N 种方法;

### 5.9 IE6 高度无法小于 10px

添加 `overflow` 的属性
设置 `font-size` 的属性为高度的大小

### 5.10 双倍 float

```css
.divBox {
  float: left;
  width: 100px;
  margin: 0 0 0 100px; /*这种情况之下IE会产生200px的距离*/
  display: inline; /*使浮动忽略*/
}
```

### 5.11 ul 列表边距属性不统一

IE 下 `ul` 的边距是使用 `margin`
firefox 下 `ul` 的边距是使用 `padding`

重置 CSS 基本样式， 统一使用 `margin` 或者 `padding`

### 5.12 IE6 下 select 元素显示 bug

`select` 元素在 IE6 下是以窗口的形式展现的，所以在你需要弹出一个提示框（modal）的时候，你会发现 `select` 在 modal 的上面，无论你设置多大 `z-index` 都无效。解决的方法也很简单，利用一个透明的 `iframe` 盖住 `select` 就可以了

```html
<div class="wrapper">
  <!--[if IE 6]>
    <iframe
      style="position:absolute;top:0;left:0;width:100%;height:100px;
    z-index:-1;filter:alpha(opacity=0);opacity=0;border-style:none;"
    >
    </iframe>
  <![endif]-->
  <!--  TODO;  -->
</div>
```

## 6.writing-mode 详解

和 `float` 属性有些类似，`writing-mode` 原本设计的是控制内联元素的显示的（即所谓的文本布局 Text Layout）。因为在亚洲，尤其像中国这样的东亚国家，存在文字的排版不是水平式的，而是垂直的，例如中国的古诗古文。

因此，`writing-mode` 就是用来实现文字可以竖着呈现的。

- 需要关注的 `writing-mode` 属性值

如果你的项目需要兼容 IE7，则只有关注这两个值就可以了：初始值 `lr-tb` 和 `tb-rl`，对应于 CSS3 规范中的 `horizontal-tb` 和 `vertical-rl`！其他 9 个属性值就让它们去过家家好了。

如果你的项目只需要兼容 IE8+，恭喜你，你可以和 CSS3 规范属性完全对应上了，而且 IE8 下的 `writing-mode` 要比 IE7 强大的多。我们需要关注：初始值 `lr-tb`， `tb-rl` 以及 `tb-lr`，分别对应于 CSS3 中的 `horizontal-tb`， `vertical-rl` 以及 `vertical-lr`。

看上去复杂的属性是不是变得很简单了，重新整一个实战版：

```css
writing-mode: lr-tb | tb-rl | tb-lr (IE8 +);
writing-mode: horizontal-tb | vertical-rl | vertical-lr;
```

对，大家只要记住上面几个就可以了，enough! 因为所谓的垂直排版，实际 web 开发是很少很少遇到的。

有同学可能要疑问了，既然 `writing-mode` 实现文本垂直排版场景有限，那还有什么学习的意义呢？

前面也提到了，虽然 `writing-mode` 创造的本意是文本布局，但是，其带来的文档流向的改变，不仅改变了我们多年来正常的 CSS 认知，同时可以巧妙实现很多意想不到的需求和效果。

### 6.1.writing-mode 不经意改变了哪些规则？

`writing-mode` 将页面默认的水平流改成了垂直流，颠覆了很多我们以往的认知，基于原本水平方向才适用的规则全部都可以在垂直方向适用！

- 1.水平方向也能 `margin` 重叠

清清楚楚写的 `bottom margin` 和 `top margin` 会重叠；然而，这是 CSS2 文档中的描述，在 CSS3 的世界中，由于 `writing-mode` 的存在，这种说法就不严谨了，应该是对立流方向的 `margin` 值会发生重叠。换句话说，如果元素是默认的水平流，则垂直 `margin` 会重叠；如果元素是垂直流，则水平 `margin` 会重叠。

- 2.可以使用 `margin:auto` 实现垂直居中

我们应该都是的，传统的 web 流中，`margin` 设置 `auto` 值的时候，只有水平方向才会居中，因为默认 `width` 是 100% 自适应的，`auto` 才有计算值可依，而垂直方向，`height` 没有任何设置的时候高度绝不会自动和父级高度一致，因此，`auto` 没有计算空间，于是无法实现垂直居中。但是，在 `writing-mode` 的世界里，纵横规则已经改变，元素的行为表现发生了翻天覆地的变化。

但是，在 IE 浏览器下，却没有垂直居中~~

难道 IE 不支持垂直流下的垂直居中？非也，根据鄙人的测试，也就是图片这类替换元素貌似不行，普通的 `block` 元素都是可以的。

- 3.可以使用 `text-align:center` 实现图片垂直居中

- 4.可以使用 `text-indent` 实现文字下沉效果

- 5.可以实现全兼容的 `icon fonts` 图标的旋转效果

- 6.充分利用高度的高度自适应布局

### 6.2.writing-mode 和 direction 的关系

`writing-mode`， `direction`， `unicode-bidi`(MDN 文档)是 CSS 世界中 3 大可以改变文本布局流向的属性。其中 `direction`， `unicode-bidi` 属于近亲，经常在一起使用，也是唯一两个不受 CSS3 `all` 属性影响的 CSS 属性，基本上就是和内联元素一起使用使用。

乍一看，`writing-mode` 似乎包含了 `direction`， `unicode-bidi` 某些功能和行为，例如 `vertical-rl` 的 `rl` 和 `direction` 的 `rtl` 值有相似之处，都是从右往左。然而，实际上，两者是没有交集的。因为 `vertical-rl` 此时的文档流为垂直方向，`rl` 表示水平方向，此时再设置 `direction:rtl`，实际上值 `rtl` 改变的是垂直方向的内联元素的文本方向，一横一纵，没有交集。而且 `writing-mode` 可以对块状元素产生影响，直接改变了 CSS 世界的纵横规则，要比 `direction` 强大和鬼畜的多。

### 6.3.writing-mode 和 `-start` 属性的流机制

CSS3 中出现了诸多 `-start/-end` 属性（亦称为**CSS 逻辑属性**），例如：`margin-start/margin-end， border-start/border-end， padding-start/padding-end`， 以及 `text-align:start/text-align:end` 声明。

下面问题来了，为什么会蹦出这么多 `-start/-end` 鬼？

那是因为现代浏览器加强了对流的支持，包括老江湖 `direction`，以及最近年月跟进的 `writing-mode`。

在很久以前，我们的认知里，网页布局就一种流向，就是从左往右，从上往下，因此，我们使用 `margin-left/margin-right` 没有任何问题。但是，如果我们流是可以变化的，例如，一张图片距离左边缘 20 像素，我们希望其文档流是从右往左，同时距离右侧是 20 像素，怎么办？

此时，`margin-left:20px` 在图片 `direction` 变化后，就无效了；但是，`margin-start` 就不会有此问题，所谓 `start`，指的是文档流开始的方向，换句话说，如果页面是默认的文档流，则 `margin-start` 等同于 `margin-left`，如果是水平从右往左文档流，则 `margin-start` 等同于 `margin-right`。`margin-end` 也是类似的。

webkit 内核的浏览器还支持 `-before和-end`，默认流下的 `margin-before` 近似于`margin-top`，`margin-after` 近似于 `margin-bottom`，然而，规范貌似没提及，FireFox 也没支持，`-before和-after` 出场的机会并不多，为什么呢？因为实际上，配合`writing-mode`，`-start/-end` 已经可以满足我们对逻辑位置的需求了，水平和垂直都可以控制，对立方向适用老的 `-top/-bottom`.

例如，我们设置 `writing-mode` 值为 `vertical-rl`，此时 `margin-start` 等同于 `margin-top`，如果此时 `margin-start`，`margin-top` 同时存在，会遵循权重和后来居上原则进行相互的覆盖。

可以看到，场景不同，`margin-start` 的作用也不能，能上能下，能左能右简直在世百变星君。

关于 `-start/-end` 以后有机会会具体展开论述，这里就先点到为止，大家估计目前也不会在实际项目中使用。
