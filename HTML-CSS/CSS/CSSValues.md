# CSS 取值

## 百分比取值

要理解诸如 100%这样的百分比值，其关键点是要明白，百分比是一定有其对应的参照值的。也就是说，百分比值是一种相对值，任何时候要分析它的效果，都需要正确找到它的参照。

一个 css 属性值从定义到最终实际使用，是存在一个过程的。这其中涉及到 Specified Values（指定值）、Computed Values（计算值）、 Used Values（使用值）、Actual Values（实际值）等概念，可以想见到，百分比值实际会在这个过程中，根据它的参照计算转化为一个绝对值（比如 100px），然后再被应用。这就是百分比值的意义。

### 1.百分比值的作用

简单地说，就是可变性。这可以衍生出自适应、响应式等看起来很有用的东西。

### 2.可用百分比值的常见 css 属性

#### 2.1.width & height

宽和高在使用百分比值时，其参照都是元素的包含块（Containing Block，详情）。width 参照包含块的宽度，height 参照包含块的高度。在大部分情况下，包含块就是父元素的内容区（盒模型里的 content）。

写过 `width:100%; height:100%;` 这样的代码来实现尺寸和父元素一致。但我发现有时候宽度是符合意思（100%）的，但高度却没有效果。关于这一点的详细解释是，当一个元素的高度使用百分比值，如果其包含块没有明确的高度定义（也就是说，取决于内容高度），且这个元素不是绝对定位，则该百分比值等同于 auto。auto 是初始默认值，所以看起来就像是“失效”了。

如果元素是根元素（`<html>`），它的包含块是视口（viewport）提供的初始包含块（initial containing block），初始包含块任何时候都被认为是有高度定义的，且等于视口高度。所以，`<html>` 标签的高度定义百分比总是有效的，而如果你希望在 `<body>` 里也用高度百分比，就一定要先为 `<html>` 定义明确的高度。这就是为什么在固定页脚一文中，有 `html, body{height:100%;}` 这样的写法。

#### 2.2.margin & padding

对于 margin 和 padding，其任意方向的百分比值，参照都是包含块的宽度。

> 严格地说，参照是包含块的宽度，是在样式属性 writing-mode 为默认值时的情况。不过这个属性极少被用到，所以在此不做考虑。

#### 2.3.border-radius

为一个元素的 border-radius 定义的百分比值，参照物是这个元素自身的尺寸。

#### 2.4.background-position

background-position 的初始值就是百分比值 0% 0%。background-position 的百分比值，取的参照是一个减法计算值，由放置背景图的区域尺寸，减去背景图的尺寸得到，可以为负值。这个属性包括水平位置和垂直位置，它们分别参照的是宽度减法计算值和高度减法计算值。

#### 2.5.font-size

参照是直接父元素的 font-size。例如，一个元素的直接父元素的 font-size 是 14px，无论这个是直接定义的，还是继承得到的，当该元素定义 `font-size:100%;`，获得的效果就是 `font-size:14px;`。

#### 2.6.line-height

参照是元素自身的 font-size。例如，一个元素的 font-size 是 12px，那么 `line-height:150%;` 的效果是 `line-height:18px;`。

#### 2.7.vertical-align

参照是元素自身的 line-height（和前面很有关联吧，所以我排在了这里）。例如，一个元素的 line-height 是 30px，则 `vertical-align:10%;` 的效果是 `vertical-align:3px;`。

对这个属性我还想说，尽管 vertical-align 可以使用数字，百分比值，但浏览器兼容性差异较大，在跨浏览器实现时可能需要较多 hack。因此，我个人倾向于使用 middle 等相对来说兼容性差异较小的关键字类型的值。

#### 2.8.定位用的 bottom、left、right、top

参照是元素的包含块。left 和 right 是参照包含块的宽度，bottom 和 top 是参照包含块的高度。

#### 2.9.transform: translate

平移变换，在水平方向和垂直方向上也可以使用百分比，其参照是变换的边界框的尺寸（等于这个元素自己的 border-box 尺寸）。例如，一个宽度为 150px，高度为 100px 的元素，定义 `transform:translate(50%, 50%)` 的效果是 `transform:translate(75px, 50px);`。

还可以补充一点，translate3d 对应是还有第三个维度的，但是，经过测试，最后的第 3 个值不可以使用百分比（否则样式定义无效）。至于为什么不可以参照呢，大概是因为那是神秘的第三维度吧...

### 3.百分比值的继承

请注意，当百分比值用于可继承属性时，只有结合参照值计算后的绝对值会被继承，而不是百分比值本身。例如，一个元素的 font-size 是 14px，并定义了 line-height:150%;，那么该元素的下一级子元素继承到的 line-height 就是 21px，而不会再和子元素自己的 font-size 有关。

[详述css中的百分比值](http://acgtofe.com/posts/2014/06/percentage-in-css)
